<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Multi-Step Formular</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      .form-step {
        display: none;
      }
      .form-step.active {
        display: block;
      }
      .progress-bar {
        display: flex;
        justify-content: space-between;
        margin-bottom: 1rem;
      }
      .progress-bar span {
        flex: 1;
        height: 0.5rem;
        background-color: #e5e7eb;
        margin-right: 0.25rem;
        border-radius: 9999px;
      }
      .progress-bar span.active {
        background-color: #6366f1;
      }
      .peer-checked .text-white {
        display: block;
      }
    </style>
  </head>
  <body class="bg-white text-gray-900">
    <div class="flex items-center justify-center px-4">
      <form id="bakkah_form" class="h-full w-full max-w-2xl">
        <!-- Progress Bar -->
        <div class="progress-bar" id="progressBar">
          <span class="active"></span>
          <span></span>
          <span></span>
          <span></span>
        </div>

        <!-- Step 1: Persönliche Daten -->
        <div class="form-step active">
          <h2 class="text-3xl font-semibold mb-6">Persönliche Daten</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label for="firstname" class="block text-lg font-medium"
                >Vorname</label
              >
              <input
                type="text"
                id="firstname"
                name="firstname"
                class="mt-2 block w-full border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-lg p-3"
                required
              />
            </div>
            <div>
              <label for="lastname" class="block text-lg font-medium"
                >Nachname</label
              >
              <input
                type="text"
                id="lastname"
                name="lastname"
                class="mt-2 block w-full border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-lg p-3"
                required
              />
            </div>
          </div>
          <div class="flex justify-end mt-8">
            <button
              type="button"
              class="bg-indigo-500 text-white py-3 px-6 rounded-lg shadow hover:bg-indigo-600 text-lg"
              onclick="nextStep()"
            >
              Weiter
            </button>
          </div>
        </div>

        <!-- Step 2: Kontaktinformationen -->
        <div class="form-step">
          <h2 class="text-3xl font-semibold mb-6">Kontaktinformationen</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label for="email" class="block text-lg font-medium"
                >E-Mail</label
              >
              <input
                type="email"
                id="email"
                name="email"
                class="mt-2 block w-full border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-lg p-3"
                required
              />
            </div>
            <div>
              <label for="phone" class="block text-lg font-medium"
                >Telefonnummer</label
              >
              <input
                type="text"
                id="phone"
                name="phone"
                class="mt-2 block w-full border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-lg p-3"
                required
              />
            </div>
          </div>
          <div class="flex justify-between mt-8">
            <button
              type="button"
              class="bg-gray-300 text-gray-700 py-3 px-6 rounded-lg shadow hover:bg-gray-400 text-lg"
              onclick="prevStep()"
            >
              Zurück
            </button>
            <button
              type="button"
              class="bg-indigo-500 text-white py-3 px-6 rounded-lg shadow hover:bg-indigo-600 text-lg"
              onclick="nextStep()"
            >
              Weiter
            </button>
          </div>
        </div>

        <!-- Step 3: Adressdaten -->
        <div class="form-step">
          <h2 class="text-3xl font-semibold mb-6">Adressdaten</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label for="street" class="block text-lg font-medium"
                >Straße</label
              >
              <input
                type="text"
                id="street"
                name="street"
                class="mt-2 block w-full border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-lg p-3"
                required
              />
            </div>
            <div>
              <label for="postcode" class="block text-lg font-medium"
                >Postleitzahl</label
              >
              <input
                type="text"
                id="postcode"
                name="postcode"
                class="mt-2 block w-full border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-lg p-3"
                required
              />
            </div>
            <div>
              <label for="city" class="block text-lg font-medium">Stadt</label>
              <input
                type="text"
                id="city"
                name="city"
                class="mt-2 block w-full border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-lg p-3"
                required
              />
            </div>
            <div>
              <label for="land" class="block text-lg font-medium">Land</label>
              <select
                id="land"
                name="land"
                class="mt-2 block w-full border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-lg p-3"
                required
              ></select>
            </div>
          </div>
          <div class="flex justify-between mt-8">
            <button
              type="button"
              class="bg-gray-300 text-gray-700 py-3 px-6 rounded-lg shadow hover:bg-gray-400 text-lg"
              onclick="prevStep()"
            >
              Zurück
            </button>
            <button
              type="button"
              class="bg-indigo-500 text-white py-3 px-6 rounded-lg shadow hover:bg-indigo-600 text-lg"
              onclick="nextStep()"
            >
              Weiter
            </button>
          </div>
        </div>

        <!-- Step 4: Reiseart -->
        <div class="form-step">
          <h2 class="text-3xl font-semibold mb-6">Reiseart</h2>
          <div class="grid grid-cols-1 gap-6">
            <div>
              <label for="reiseart" class="block text-lg font-medium"
                >Bitte wählen Sie die Reiseart</label
              >
              <select
                id="reiseart"
                name="reiseart"
                class="mt-2 block w-full border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-lg p-3"
                required
              >
                <option value="Umra">Umra</option>
                <option value="Hadsch">Hadsch</option>
              </select>
            </div>
          </div>
          <div class="flex justify-between mt-8">
            <button
              type="button"
              class="bg-gray-300 text-gray-700 py-3 px-6 rounded-lg shadow hover:bg-gray-400 text-lg"
              onclick="prevStep()"
            >
              Zurück
            </button>
            <button
              type="button"
              class="bg-indigo-500 text-white py-3 px-6 rounded-lg shadow hover:bg-indigo-600 text-lg"
              onclick="nextStep()"
            >
              Weiter
            </button>
          </div>
        </div>

        <!-- Step 5: AGB und Abschluss -->
        <div class="form-step">
          <h2 class="text-3xl font-semibold mb-6">Abschluss</h2>
          <div class="mt-6">
            <label for="agb" class="flex items-center gap-4">
              <input
                type="checkbox"
                id="agb"
                name="agb"
                class="hidden peer"
                required
              />
              <span
                class="w-6 h-6 flex items-center justify-center border-2 border-gray-300 rounded-lg peer-checked:bg-indigo-500 peer-checked:border-indigo-500"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="w-4 h-4 text-white hidden peer-checked:block"
                  viewBox="0 0 20 20"
                  fill="white"
                >
                  <path
                    fill-rule="evenodd"
                    d="M16.707 5.293a1 1 0 01.083 1.32l-.083.094L8.707 14.707a1 1 0 01-1.32.083l-.094-.083-4-4a1 1 0 011.32-1.497l.094.083L8 12.584l7.293-7.293a1 1 0 011.414 0z"
                    clip-rule="evenodd"
                  />
                </svg>
              </span>
              <span class="text-lg">Ich akzeptiere die AGB.</span>
            </label>
          </div>
          <div class="flex justify-between mt-8">
            <button
              type="button"
              class="bg-gray-300 text-gray-700 py-3 px-6 rounded-lg shadow hover:bg-gray-400 text-lg"
              onclick="prevStep()"
            >
              Zurück
            </button>
            <button
              type="submit"
              class="bg-indigo-500 text-white py-3 px-6 rounded-lg shadow hover:bg-indigo-600 text-lg"
              required
            >
              Abschicken
            </button>
          </div>
        </div>
      </form>
    </div>

    <script>
      let currentStep = 0;
      const steps = document.querySelectorAll('.form-step');
      const progressBar = document.querySelectorAll('#progressBar span');
      const landSelect = document.getElementById('land');

      async function loadCountries() {
        try {
          const response = await fetch('https://restcountries.com/v3.1/all');
          if (!response.ok) throw new Error('Fehler beim Abrufen der Länder');

          const countries = await response.json();
          const countryOptions = countries
            .map((country) => {
              const germanName =
                country.translations?.deu?.common || country.name.common;
              return `<option value="${germanName}" ${
                germanName === 'Deutschland' ? 'selected' : ''
              }>${germanName}</option>`;
            })
            .sort()
            .join('');
          landSelect.innerHTML = countryOptions;
        } catch (error) {
          console.error('Fehler:', error);
          landSelect.innerHTML =
            '<option value="">Fehler beim Laden der Länder</option>';
        }
      }

      loadCountries();

      function showStep(step) {
        steps.forEach((s, index) => {
          s.classList.toggle('active', index === step);
        });
        progressBar.forEach((bar, index) => {
          bar.classList.toggle('active', index <= step);
        });
      }

      function nextStep() {
        if (currentStep < steps.length - 1) {
          currentStep++;
          showStep(currentStep);
        }
      }

      function prevStep() {
        if (currentStep > 0) {
          currentStep--;
          showStep(currentStep);
        }
      }

      document.addEventListener('DOMContentLoaded', () => {
        const form = document.getElementById('bakkah_form');
        if (form) {
          form.addEventListener('submit', async (e) => {
            e.preventDefault();

            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData);

            try {
              const response = await fetch(
                'https://hooks.zapier.com/hooks/catch/8057500/2kzxxip/',
                {
                  method: 'POST',
                  headers: {
                    'Content-Type': 'application/json',
                  },
                  body: JSON.stringify(data),
                }
              );

              if (response.ok) {
                alert('Formular erfolgreich abgeschickt!');
              } else {
                alert('Fehler beim Senden des Formulars.');
              }
            } catch (error) {
              alert(
                'Netzwerkfehler: Das Formular konnte nicht gesendet werden.'
              );
            }
          });
        } else {
          console.error(
            'Formular mit ID "multiStepForm" wurde nicht gefunden.'
          );
        }
      });
    </script>
  </body>
</html>
